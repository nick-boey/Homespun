@using Homespun.Client.Components

<div class="showcase-section">
    <h3>Default State</h3>
    <div class="showcase-item">
        <div class="showcase-label">Primary action with dropdown</div>
        <div class="showcase-preview">
            <SplitButton PrimaryText="Pull"
                         PrimaryOnClick="HandlePrimaryClick"
                         Variant="ButtonVariant.Default"
                         Actions="@_defaultActions">
                <PrimaryIcon>
                    <LucideIcon Name="cloud-download" Size="14" Class="me-1" />
                </PrimaryIcon>
            </SplitButton>
        </div>
    </div>
</div>

<div class="showcase-section">
    <h3>Button Variants</h3>
    <div class="showcase-item">
        <div class="showcase-label">Outline style</div>
        <div class="showcase-preview">
            <SplitButton PrimaryText="Pull"
                         PrimaryOnClick="HandlePrimaryClick"
                         Variant="ButtonVariant.Outline"
                         Actions="@_defaultActions">
                <PrimaryIcon>
                    <LucideIcon Name="cloud-download" Size="14" Class="me-1" />
                </PrimaryIcon>
            </SplitButton>
        </div>
    </div>
    <div class="showcase-item">
        <div class="showcase-label">Secondary style</div>
        <div class="showcase-preview">
            <SplitButton PrimaryText="Pull"
                         PrimaryOnClick="HandlePrimaryClick"
                         Variant="ButtonVariant.Secondary"
                         Actions="@_defaultActions">
                <PrimaryIcon>
                    <LucideIcon Name="cloud-download" Size="14" Class="me-1" />
                </PrimaryIcon>
            </SplitButton>
        </div>
    </div>
</div>

<div class="showcase-section">
    <h3>Size Variants</h3>
    <div class="showcase-item">
        <div class="showcase-label">Small size</div>
        <div class="showcase-preview">
            <SplitButton PrimaryText="Pull"
                         PrimaryOnClick="HandlePrimaryClick"
                         Variant="ButtonVariant.Outline"
                         Size="ButtonSize.Small"
                         Actions="@_defaultActions">
                <PrimaryIcon>
                    <LucideIcon Name="cloud-download" Size="14" Class="me-1" />
                </PrimaryIcon>
            </SplitButton>
        </div>
    </div>
    <div class="showcase-item">
        <div class="showcase-label">Regular size</div>
        <div class="showcase-preview">
            <SplitButton PrimaryText="Pull"
                         PrimaryOnClick="HandlePrimaryClick"
                         Variant="ButtonVariant.Outline"
                         Actions="@_defaultActions">
                <PrimaryIcon>
                    <LucideIcon Name="cloud-download" Size="14" Class="me-1" />
                </PrimaryIcon>
            </SplitButton>
        </div>
    </div>
</div>

<div class="showcase-section">
    <h3>Loading State</h3>
    <div class="showcase-item">
        <div class="showcase-label">External loading control</div>
        <div class="showcase-preview">
            <SplitButton PrimaryText="Pull"
                         PrimaryLoadingText="Pulling..."
                         PrimaryOnClick="HandlePrimaryClick"
                         Variant="ButtonVariant.Outline"
                         IsLoadingExternal="@_isLoading"
                         Actions="@_defaultActions">
                <PrimaryIcon>
                    <LucideIcon Name="cloud-download" Size="14" Class="me-1" />
                </PrimaryIcon>
            </SplitButton>
            <BbButton Variant="ButtonVariant.Secondary" Size="ButtonSize.Small" Class="ms-3" OnClick="ToggleLoading">
                Toggle Loading
            </BbButton>
        </div>
    </div>
</div>

<div class="showcase-section">
    <h3>Disabled State</h3>
    <div class="showcase-item">
        <div class="showcase-label">Disabled split button</div>
        <div class="showcase-preview">
            <SplitButton PrimaryText="Pull"
                         PrimaryOnClick="HandlePrimaryClick"
                         Variant="ButtonVariant.Outline"
                         Disabled="true"
                         Actions="@_defaultActions">
                <PrimaryIcon>
                    <LucideIcon Name="cloud-download" Size="14" Class="me-1" />
                </PrimaryIcon>
            </SplitButton>
        </div>
    </div>
</div>

<div class="showcase-section">
    <h3>Multiple Actions</h3>
    <div class="showcase-item">
        <div class="showcase-label">Multiple dropdown options</div>
        <div class="showcase-preview">
            <SplitButton PrimaryText="Save"
                         PrimaryOnClick="HandlePrimaryClick"
                         Variant="ButtonVariant.Default"
                         Actions="@_multipleActions">
                <PrimaryIcon>
                    <LucideIcon Name="save" Size="14" Class="me-1" />
                </PrimaryIcon>
            </SplitButton>
        </div>
    </div>
</div>

@code {
    private bool _isLoading;

    private IReadOnlyList<SplitButtonAction> _defaultActions = [];
    private IReadOnlyList<SplitButtonAction> _multipleActions = [];

    protected override void OnInitialized()
    {
        _defaultActions =
        [
            new SplitButtonAction(
                Key: "sync",
                Text: "Sync",
                Icon: (RenderFragment)(builder =>
                {
                    builder.OpenComponent<LucideIcon>(0);
                    builder.AddAttribute(1, "Name", "cloud-upload");
                    builder.AddAttribute(2, "Size", 14);
                    builder.CloseComponent();
                }),
                OnClick: EventCallback.Factory.Create(this, HandleSyncClick))
        ];

        _multipleActions =
        [
            new SplitButtonAction(
                Key: "save-draft",
                Text: "Save as Draft",
                Icon: (RenderFragment)(builder =>
                {
                    builder.OpenComponent<LucideIcon>(0);
                    builder.AddAttribute(1, "Name", "file");
                    builder.AddAttribute(2, "Size", 14);
                    builder.CloseComponent();
                }),
                OnClick: EventCallback.Factory.Create(this, HandleSaveClick)),
            new SplitButtonAction(
                Key: "save-publish",
                Text: "Save and Publish",
                Icon: (RenderFragment)(builder =>
                {
                    builder.OpenComponent<LucideIcon>(0);
                    builder.AddAttribute(1, "Name", "send");
                    builder.AddAttribute(2, "Size", 14);
                    builder.CloseComponent();
                }),
                OnClick: EventCallback.Factory.Create(this, HandleSaveClick)),
            new SplitButtonAction(
                Key: "export",
                Text: "Export",
                Icon: (RenderFragment)(builder =>
                {
                    builder.OpenComponent<LucideIcon>(0);
                    builder.AddAttribute(1, "Name", "download");
                    builder.AddAttribute(2, "Size", 14);
                    builder.CloseComponent();
                }),
                OnClick: EventCallback.Factory.Create(this, HandleSaveClick))
        ];
    }

    private Task HandlePrimaryClick()
    {
        return Task.CompletedTask;
    }

    private Task HandleSyncClick()
    {
        return Task.CompletedTask;
    }

    private Task HandleSaveClick()
    {
        return Task.CompletedTask;
    }

    private void ToggleLoading()
    {
        _isLoading = !_isLoading;
    }
}
