@* Consolidated showcase for Toolbar components. *@
@using Homespun.Client.Components.Toolbar

<h2>ToolbarButton</h2>

<div class="showcase-section">
    <h3>Default State</h3>
    <div class="showcase-item">
        <div class="showcase-label">Basic button with icon</div>
        <div class="showcase-preview">
            <div style="display: flex; gap: 1rem; align-items: center;">
                <ToolbarButton Icon="pencil" />
                <ToolbarButton Icon="play" />
                <ToolbarButton Icon="square" />
            </div>
        </div>
    </div>
</div>

<div class="showcase-section">
    <h3>With Tooltips</h3>
    <div class="showcase-item">
        <div class="showcase-label">Buttons showing tooltip on hover with keyboard shortcuts</div>
        <div class="showcase-preview">
            <div style="display: flex; gap: 1rem; align-items: center; padding-top: 40px;">
                <ToolbarButton Icon="pencil" Tooltip="Edit issue (i)" />
                <ToolbarButton Icon="play" Tooltip="Run agent" />
                <ToolbarButton Icon="refresh-cw" Tooltip="Sync (Ctrl+S)" />
            </div>
            <p style="color: var(--text-muted); font-size: 12px; margin-top: 16px;">
                Hover over the buttons to see the tooltips appear above.
            </p>
        </div>
    </div>
</div>

<div class="showcase-section">
    <h3>Disabled State</h3>
    <div class="showcase-item">
        <div class="showcase-label">Buttons are disabled with reduced opacity and no-click cursor</div>
        <div class="showcase-preview">
            <div style="display: flex; gap: 1rem; align-items: center;">
                <ToolbarButton Icon="pencil" Tooltip="Edit issue (i)" Disabled="true" />
                <ToolbarButton Icon="play" Tooltip="Run agent" Disabled="true" />
            </div>
        </div>
    </div>
</div>

<div class="showcase-section">
    <h3>Various Icons</h3>
    <div class="showcase-item">
        <div class="showcase-label">Different Lucide icons for various actions</div>
        <div class="showcase-preview">
            <div style="display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
                <ToolbarButton Icon="pencil" Tooltip="Edit" />
                <ToolbarButton Icon="play" Tooltip="Play" />
                <ToolbarButton Icon="square" Tooltip="Stop" />
                <ToolbarButton Icon="trash-2" Tooltip="Delete" />
                <ToolbarButton Icon="plus" Tooltip="Add" />
                <ToolbarButton Icon="settings" Tooltip="Settings" />
                <ToolbarButton Icon="refresh-cw" Tooltip="Refresh" />
                <ToolbarButton Icon="download" Tooltip="Download" />
            </div>
        </div>
    </div>
</div>

<div class="showcase-section">
    <h3>Interactive Demo</h3>
    <div class="showcase-item">
        <div class="showcase-label">Click the buttons to see callback invocation</div>
        <div class="showcase-preview">
            <div style="display: flex; gap: 1rem; align-items: center;">
                <ToolbarButton Icon="pencil"
                               Tooltip="Edit (click me)"
                               OnClick="@(() => HandleButtonClick("Edit"))" />
                <ToolbarButton Icon="play"
                               Tooltip="Run (click me)"
                               OnClick="@(() => HandleButtonClick("Run"))" />
            </div>
            @if (!string.IsNullOrEmpty(_buttonLastAction))
            {
                <div style="margin-top: 1rem; padding: 0.5rem; background: var(--bg-tertiary); border-radius: 4px; font-size: 12px; color: var(--text-muted);">
                    Last action: @_buttonLastAction
                </div>
            }
        </div>
    </div>
</div>

<h2>ProjectToolbar</h2>

<div class="showcase-section">
    <h3>Full Toolbar</h3>
    <div class="showcase-item">
        <div class="showcase-label">All button groups: Create | Hierarchy | Undo/Redo | Edit/Run</div>
        <div class="showcase-preview">
            <ProjectToolbar ProjectId="demo-project"
                            SelectedIssueId="TEST-001"
                            OnEditClick="HandleToolbarEditClick"
                            OnUndo="HandleUndo"
                            OnRedo="HandleRedo"/>
            @if (!string.IsNullOrEmpty(_toolbarLastAction))
            {
                <div
                    style="margin-top: 12px; padding: 0.5rem; background: var(--bg-tertiary); border-radius: 4px; font-size: 12px; color: var(--text-muted);">
                    Last action: @_toolbarLastAction
                </div>
            }
        </div>
    </div>
</div>

<div class="showcase-section">
    <h3>No Issue Selected</h3>
    <div class="showcase-item">
        <div class="showcase-label">Most buttons are disabled when no issue is selected</div>
        <div class="showcase-preview">
            <ProjectToolbar ProjectId="demo-project"
                            SelectedIssueId="@null"
                            CreateDisabled="true"
                            ChildOfDisabled="true"
                            ParentOfDisabled="true"/>
            <p style="color: var(--text-muted); font-size: 12px; margin-top: 12px;">
                Create, hierarchy, edit, and run buttons are disabled.
            </p>
        </div>
    </div>
</div>

<div class="showcase-section">
    <h3>Child Of Selection Mode</h3>
    <div class="showcase-item">
        <div class="showcase-label">The "Make Child Of" button shows active state with ring highlight</div>
        <div class="showcase-preview">
            <ProjectToolbar ProjectId="demo-project"
                            SelectedIssueId="TEST-001"
                            ChildOfActive="true"
                            ParentOfDisabled="true"/>
            <p style="color: var(--text-muted); font-size: 12px; margin-top: 12px;">
                Click another issue to make the selected issue a child of it.
            </p>
        </div>
    </div>
</div>

<div class="showcase-section">
    <h3>Parent Of Selection Mode</h3>
    <div class="showcase-item">
        <div class="showcase-label">The "Make Parent Of" button shows active state with ring highlight</div>
        <div class="showcase-preview">
            <ProjectToolbar ProjectId="demo-project"
                            SelectedIssueId="TEST-001"
                            ParentOfActive="true"
                            ChildOfDisabled="true"/>
            <p style="color: var(--text-muted); font-size: 12px; margin-top: 12px;">
                Click another issue to make it a child of the selected issue.
            </p>
        </div>
    </div>
</div>

<div class="showcase-section">
    <h3>Undo/Redo Available</h3>
    <div class="showcase-item">
        <div class="showcase-label">Undo and redo buttons with custom tooltips</div>
        <div class="showcase-preview">
            <ProjectToolbar ProjectId="demo-project"
                            SelectedIssueId="TEST-001"
                            UndoTooltip="Undo: Create issue 'Add dark mode'"
                            RedoTooltip="Redo: Delete issue 'Fix bug'"
                            OnUndo="HandleUndo"
                            OnRedo="HandleRedo"/>
        </div>
    </div>
</div>

<div class="showcase-section">
    <h3>Undo/Redo Disabled</h3>
    <div class="showcase-item">
        <div class="showcase-label">When there's nothing to undo or redo</div>
        <div class="showcase-preview">
            <ProjectToolbar ProjectId="demo-project"
                            SelectedIssueId="TEST-001"
                            UndoDisabled="true"
                            RedoDisabled="true"/>
        </div>
    </div>
</div>

<div class="showcase-section">
    <h3>Agent Running</h3>
    <div class="showcase-item">
        <div class="showcase-label">Run button is disabled when agent is running on selected issue</div>
        <div class="showcase-preview">
            <div style="display: flex; align-items: center; gap: 12px;">
                <ProjectToolbar ProjectId="demo-project"
                                SelectedIssueId="TEST-002"
                                IsAgentRunning="true"/>
                <span class="agent-status-badge"
                      style="font-size: 11px; padding: 2px 8px; border-radius: 4px; background: rgba(81, 165, 193, 0.2); color: var(--color-ocean);">
                    Agent Working
                </span>
            </div>
            <p style="color: var(--text-muted); font-size: 12px; margin-top: 12px;">
                All other buttons remain enabled. Run button is disabled while agent is active.
            </p>
        </div>
    </div>
</div>

<div class="showcase-section">
    <h3>In Context</h3>
    <div class="showcase-item">
        <div class="showcase-label">Toolbar appearance in the sticky header context</div>
        <div class="showcase-preview"
             style="background: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 6px; padding: 16px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                <h2 style="margin: 0; font-size: 20px;">Demo Project</h2>
                <div style="display: flex; gap: 8px;">
                    <button class="btn btn-outline btn-sm">Pull</button>
                    <button class="btn btn-outline btn-sm">Edit Project</button>
                </div>
            </div>
            <ProjectToolbar ProjectId="demo-project"
                            SelectedIssueId="DEMO-001"
                            OnEditClick="HandleToolbarEditClick"
                            OnUndo="HandleUndo"
                            OnRedo="HandleRedo"/>
            <div style="border-bottom: 1px solid var(--border-color); margin-top: 8px;"></div>
            <p style="color: var(--text-muted); font-size: 12px; margin-top: 12px;">
                This simulates how the toolbar appears in the project page sticky header.
            </p>
        </div>
    </div>
</div>

@code {
    // ToolbarButton
    private string? _buttonLastAction;

    private void HandleButtonClick(string action)
    {
        _buttonLastAction = $"{action} button clicked at {DateTime.Now:HH:mm:ss}";
    }

    // ProjectToolbar
    private string? _toolbarLastAction;

    private void HandleToolbarEditClick(string issueId)
    {
        _toolbarLastAction = $"Edit clicked for issue: {issueId}";
    }

    private void HandleUndo()
    {
        _toolbarLastAction = "Undo clicked";
    }

    private void HandleRedo()
    {
        _toolbarLastAction = "Redo clicked";
    }
}
