<BbTooltipProvider>
    <BbTooltip DelayDuration="0">
        <BbTooltipTrigger>
            <BbButton Variant="ButtonVariant.Outline"
                      Class="@GetButtonClass()"
                      Disabled="@Disabled"
                      OnClick="HandleClick"
                      data-testid="@TestId">
                <LucideIcon Name="@Icon" class="h-4 w-4"/>
            </BbButton>
        </BbTooltipTrigger>
        <BbTooltipContent>
            @Tooltip
        </BbTooltipContent>
    </BbTooltip>
</BbTooltipProvider>

@code {

    /// <summary>
    /// The Lucide icon name to display (e.g., "pencil", "play", "settings").
    /// </summary>
    [Parameter, EditorRequired]
    public string Icon { get; set; } = "";

    /// <summary>
    /// Tooltip text to display on hover. Should include keyboard shortcut if applicable.
    /// Example: "Edit issue (i)"
    /// </summary>
    [Parameter]
    public string? Tooltip { get; set; }

    /// <summary>
    /// Whether the button is disabled.
    /// </summary>
    [Parameter]
    public bool Disabled { get; set; }

    /// <summary>
    /// Whether the button is in an active state (e.g., selection mode).
    /// Shows a ring highlight around the button.
    /// </summary>
    [Parameter]
    public bool Active { get; set; }

    /// <summary>
    /// Callback when the button is clicked.
    /// </summary>
    [Parameter]
    public EventCallback OnClick { get; set; }

    /// <summary>
    /// Optional data-testid attribute for testing.
    /// </summary>
    [Parameter]
    public string? TestId { get; set; }

    private string GetButtonClass() => Active ? "toolbar-btn toolbar-btn-active" : "toolbar-btn";

    private async Task HandleClick()
    {
        if (Disabled) return;
        await OnClick.InvokeAsync();
    }
}
