@if (!string.IsNullOrEmpty(Message))
{
    <BbAlert Variant="@GetAlertVariant()" Class="@Class">
        <BbAlertTitle>
            @if (!string.IsNullOrEmpty(Title))
            {
                @Title
            }
        </BbAlertTitle>
        <BbAlertDescription>
            @Message
        </BbAlertDescription>
        @if (IsDismissible && OnDismiss.HasDelegate)
        {
            <BbAlertAction>
                <BbButton Variant="ButtonVariant.Ghost" Size="ButtonSize.Small" OnClick="HandleDismiss">
                    <LucideIcon Name="x" Size="14" />
                </BbButton>
            </BbAlertAction>
        }
    </BbAlert>
}

@code {
    /// <summary>
    /// The message to display.
    /// </summary>
    [Parameter]
    public string? Message { get; set; }

    /// <summary>
    /// Optional title for the message.
    /// </summary>
    [Parameter]
    public string? Title { get; set; }

    /// <summary>
    /// The type/severity of the message.
    /// </summary>
    [Parameter]
    public FormMessageType Type { get; set; } = FormMessageType.Error;

    /// <summary>
    /// Whether the message can be dismissed.
    /// </summary>
    [Parameter]
    public bool IsDismissible { get; set; }

    /// <summary>
    /// Callback when the dismiss button is clicked.
    /// </summary>
    [Parameter]
    public EventCallback OnDismiss { get; set; }

    /// <summary>
    /// Additional CSS classes to apply.
    /// </summary>
    [Parameter]
    public string? Class { get; set; }

    private async Task HandleDismiss()
    {
        if (OnDismiss.HasDelegate)
        {
            await OnDismiss.InvokeAsync();
        }
    }

    private AlertVariant GetAlertVariant()
    {
        return Type switch
        {
            FormMessageType.Error => AlertVariant.Danger,
            FormMessageType.Success => AlertVariant.Success,
            FormMessageType.Warning => AlertVariant.Warning,
            FormMessageType.Info => AlertVariant.Info,
            _ => AlertVariant.Default
        };
    }
}
