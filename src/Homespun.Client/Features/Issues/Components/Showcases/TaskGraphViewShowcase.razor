<BbCard>
    <BbCardHeader>
        <BbCardTitle>Single Orphan Issue (Actionable)</BbCardTitle>
        <BbCardDescription>A standalone actionable issue with accent-colored border marker</BbCardDescription>
    </BbCardHeader>
    <BbCardContent>
        <TaskGraphView TaskGraph="@_singleOrphan" />
    </BbCardContent>
</BbCard>

<BbCard>
    <BbCardHeader>
        <BbCardTitle>Parent-Child with Connector</BbCardTitle>
        <BbCardDescription>Child at lane 0 connects to parent at lane 1 with horizontal line and vertical connector</BbCardDescription>
    </BbCardHeader>
    <BbCardContent>
        <TaskGraphView TaskGraph="@_parentChild" />
    </BbCardContent>
</BbCard>

<BbCard>
    <BbCardHeader>
        <BbCardTitle>Multiple Siblings Sharing Parent</BbCardTitle>
        <BbCardDescription>First child uses top-right junction, subsequent siblings use right-tee junction</BbCardDescription>
    </BbCardHeader>
    <BbCardContent>
        <TaskGraphView TaskGraph="@_siblings" />
    </BbCardContent>
</BbCard>

<BbCard>
    <BbCardHeader>
        <BbCardTitle>All Marker Types</BbCardTitle>
        <BbCardDescription>Actionable (accent border), Open (muted border), Complete (green filled), Closed (gray filled)</BbCardDescription>
    </BbCardHeader>
    <BbCardContent>
        <TaskGraphView TaskGraph="@_allMarkers" />
    </BbCardContent>
</BbCard>

<BbCard>
    <BbCardHeader>
        <BbCardTitle>Selected Issue</BbCardTitle>
        <BbCardDescription>Second issue is selected with highlight background and marker glow</BbCardDescription>
    </BbCardHeader>
    <BbCardContent>
        <TaskGraphView TaskGraph="@_selectedDemo" SelectedNodeId="issue-DEMO-002" />
    </BbCardContent>
</BbCard>

<BbCard>
    <BbCardHeader>
        <BbCardTitle>With Agent Status Badges</BbCardTitle>
        <BbCardDescription>Issues with active and inactive agent sessions</BbCardDescription>
    </BbCardHeader>
    <BbCardContent>
        <TaskGraphView TaskGraph="@_agentDemo" />
    </BbCardContent>
</BbCard>

<BbCard>
    <BbCardHeader>
        <BbCardTitle>Merged PRs with Issue Connector</BbCardTitle>
        <BbCardDescription>Merged PRs connect via lane 0 vertical line to leftmost issue nodes with horizontal branches</BbCardDescription>
    </BbCardHeader>
    <BbCardContent>
        <TaskGraphView TaskGraph="@_mergedPrConnector" />
    </BbCardContent>
</BbCard>

<BbCard>
    <BbCardHeader>
        <BbCardTitle>Full Mock Graph (13 Issues)</BbCardTitle>
        <BbCardDescription>Complete task graph with orphans, chains, siblings, and multiple disconnected groups</BbCardDescription>
    </BbCardHeader>
    <BbCardContent>
        <TaskGraphView TaskGraph="@_fullMock" />
    </BbCardContent>
</BbCard>

<BbCard>
    <BbCardHeader>
        <BbCardTitle>Full Mock with Merged PRs</BbCardTitle>
        <BbCardDescription>Complete graph with merged PRs connecting to leftmost issue nodes via lane 0 spine</BbCardDescription>
    </BbCardHeader>
    <BbCardContent>
        <TaskGraphView TaskGraph="@_fullMockWithPrs" />
    </BbCardContent>
</BbCard>

<BbCard>
    <BbCardHeader>
        <BbCardTitle>Priority Markers (P0-P4)</BbCardTitle>
        <BbCardDescription>Lane 0 connectors colored by priority: P0=Red, P1=Orange, P2=Yellow, P3=Green, P4=Blue, None=Grey</BbCardDescription>
    </BbCardHeader>
    <BbCardContent>
        <TaskGraphView TaskGraph="@_priorityDemo" />
    </BbCardContent>
</BbCard>

<BbCard>
    <BbCardHeader>
        <BbCardTitle>Depth Limiting with Hidden Parent Indicators</BbCardTitle>
        <BbCardDescription>
            Use [ and ] keys to decrease/increase the number of visible levels.
            Hidden parent indicators appear as faded dots (below for series mode, right for parallel).
        </BbCardDescription>
    </BbCardHeader>
    <BbCardContent>
        <div class="showcase-depth-controls">
            <button class="showcase-depth-btn" @onclick="() => DecreaseDepth()" disabled="@(_depthLevel <= 0)">âˆ’</button>
            <span class="showcase-depth-display">@(_depthLevel + 1) level@(_depthLevel == 0 ? "" : "s")</span>
            <button class="showcase-depth-btn" @onclick="() => IncreaseDepth()" disabled="@(_depthLevel >= 5)">+</button>
        </div>
        <TaskGraphView TaskGraph="@_fullMock" MaxDepth="@_depthLevel" />
    </BbCardContent>
</BbCard>

<BbCard>
    <BbCardHeader>
        <BbCardTitle>Type Change Menu</BbCardTitle>
        <BbCardDescription>Click the type badge (Bug, Task, Feat, Chore) to open dropdown menu for changing issue type</BbCardDescription>
    </BbCardHeader>
    <BbCardContent>
        <TaskGraphView TaskGraph="@_typeChangeDemo" ProjectId="demo-project" OnIssueTypeChanged="HandleTypeChanged" />
        @if (_typeChangeMessage != null)
        {
            <div class="mt-2 text-sm text-green-500">@_typeChangeMessage</div>
        }
    </BbCardContent>
</BbCard>

<style>
    .showcase-depth-controls {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 12px;
        padding: 8px;
        background: var(--bg-secondary, rgba(255, 255, 255, 0.05));
        border-radius: 6px;
        width: fit-content;
    }

    .showcase-depth-btn {
        width: 28px;
        height: 28px;
        border: 1px solid var(--border-color, rgba(255, 255, 255, 0.1));
        border-radius: 4px;
        background: var(--bg-primary, #1a1a2e);
        color: var(--text-primary, #eaeaea);
        font-size: 16px;
        cursor: pointer;
        transition: background-color 0.15s ease, opacity 0.15s ease;
    }

    .showcase-depth-btn:hover:not(:disabled) {
        background: var(--bg-tertiary, rgba(255, 255, 255, 0.1));
    }

    .showcase-depth-btn:disabled {
        opacity: 0.4;
        cursor: not-allowed;
    }

    .showcase-depth-display {
        font-size: 13px;
        color: var(--text-secondary, #a0a0a0);
        min-width: 60px;
        text-align: center;
    }
</style>

@code {
    private string? _typeChangeMessage;
    private int _depthLevel = 3;

    private void DecreaseDepth()
    {
        if (_depthLevel > 0)
        {
            _depthLevel--;
        }
    }

    private void IncreaseDepth()
    {
        if (_depthLevel < 5)
        {
            _depthLevel++;
        }
    }

    private void HandleTypeChanged()
    {
        _typeChangeMessage = $"Type changed at {DateTime.Now:HH:mm:ss}";
        StateHasChanged();
    }

    private TaskGraphResponse _typeChangeDemo = new()
    {
        TotalLanes = 1,
        Nodes =
        [
            new() { Issue = new() { Id = "TYPE-001", Title = "Bug issue - click badge to change type", Status = IssueStatus.Open, Type = IssueType.Bug }, Lane = 0, Row = 0, IsActionable = true },
            new() { Issue = new() { Id = "TYPE-002", Title = "Task issue - click badge to change type", Status = IssueStatus.Open, Type = IssueType.Task }, Lane = 0, Row = 1, IsActionable = true },
            new() { Issue = new() { Id = "TYPE-003", Title = "Feature issue - click badge to change type", Status = IssueStatus.Open, Type = IssueType.Feature }, Lane = 0, Row = 2, IsActionable = true },
            new() { Issue = new() { Id = "TYPE-004", Title = "Chore issue - click badge to change type", Status = IssueStatus.Open, Type = IssueType.Chore }, Lane = 0, Row = 3, IsActionable = true }
        ]
    };
    private TaskGraphResponse _singleOrphan = new()
    {
        TotalLanes = 1,
        Nodes =
        [
            new() { Issue = new() { Id = "FEAT-001", Title = "Add dark mode support", Status = IssueStatus.Open }, Lane = 0, Row = 0, IsActionable = true }
        ]
    };

    private TaskGraphResponse _parentChild = new()
    {
        TotalLanes = 2,
        Nodes =
        [
            new() { Issue = new() { Id = "TASK-002", Title = "Implement login page", Status = IssueStatus.Open,
                ParentIssues = [new() { ParentIssue = "TASK-001" }] }, Lane = 0, Row = 0, IsActionable = true },
            new() { Issue = new() { Id = "TASK-001", Title = "Design authentication flow", Status = IssueStatus.Open }, Lane = 1, Row = 1, IsActionable = false }
        ]
    };

    private TaskGraphResponse _siblings = new()
    {
        TotalLanes = 2,
        Nodes =
        [
            new() { Issue = new() { Id = "TASK-010", Title = "Write unit tests", Status = IssueStatus.Open,
                ParentIssues = [new() { ParentIssue = "TASK-005" }] }, Lane = 0, Row = 0, IsActionable = true },
            new() { Issue = new() { Id = "TASK-011", Title = "Write integration tests", Status = IssueStatus.Open,
                ParentIssues = [new() { ParentIssue = "TASK-005" }] }, Lane = 0, Row = 1, IsActionable = true },
            new() { Issue = new() { Id = "TASK-012", Title = "Write e2e tests", Status = IssueStatus.Open,
                ParentIssues = [new() { ParentIssue = "TASK-005" }] }, Lane = 0, Row = 2, IsActionable = true },
            new() { Issue = new() { Id = "TASK-005", Title = "Implement feature", Status = IssueStatus.Open }, Lane = 1, Row = 3, IsActionable = false }
        ]
    };

    private TaskGraphResponse _allMarkers = new()
    {
        TotalLanes = 1,
        Nodes =
        [
            new() { Issue = new() { Id = "MRK-001", Title = "Actionable issue (next to work on)", Status = IssueStatus.Open }, Lane = 0, Row = 0, IsActionable = true },
            new() { Issue = new() { Id = "MRK-002", Title = "Open issue (blocked by dependencies)", Status = IssueStatus.Open }, Lane = 0, Row = 1, IsActionable = false },
            new() { Issue = new() { Id = "MRK-003", Title = "Completed issue", Status = IssueStatus.Complete }, Lane = 0, Row = 2, IsActionable = false },
            new() { Issue = new() { Id = "MRK-004", Title = "Closed issue (won't fix)", Status = IssueStatus.Closed }, Lane = 0, Row = 3, IsActionable = false }
        ]
    };

    private TaskGraphResponse _selectedDemo = new()
    {
        TotalLanes = 1,
        Nodes =
        [
            new() { Issue = new() { Id = "DEMO-001", Title = "First issue", Status = IssueStatus.Open }, Lane = 0, Row = 0, IsActionable = true },
            new() { Issue = new() { Id = "DEMO-002", Title = "Selected issue (highlighted)", Status = IssueStatus.Open }, Lane = 0, Row = 1, IsActionable = true },
            new() { Issue = new() { Id = "DEMO-003", Title = "Third issue", Status = IssueStatus.Open }, Lane = 0, Row = 2, IsActionable = true }
        ]
    };

    private TaskGraphResponse _agentDemo = new()
    {
        TotalLanes = 1,
        Nodes =
        [
            new() { Issue = new() { Id = "AGT-001", Title = "Issue with active agent", Status = IssueStatus.Progress }, Lane = 0, Row = 0, IsActionable = false },
            new() { Issue = new() { Id = "AGT-002", Title = "Issue with inactive agent", Status = IssueStatus.Open }, Lane = 0, Row = 1, IsActionable = true },
            new() { Issue = new() { Id = "AGT-003", Title = "Issue without agent", Status = IssueStatus.Open }, Lane = 0, Row = 2, IsActionable = true }
        ],
        AgentStatuses = new Dictionary<string, AgentStatusData>(StringComparer.OrdinalIgnoreCase)
        {
            ["AGT-001"] = new() { IsActive = true, Status = "Running", SessionId = "session-1" },
            ["AGT-002"] = new() { IsActive = false, Status = "Stopped", SessionId = "session-2" }
        }
    };

    private TaskGraphResponse _mergedPrConnector = new()
    {
        TotalLanes = 2,
        MergedPrs =
        [
            new() { Number = 42, Title = "Add user authentication", IsMerged = true, HasDescription = true },
            new() { Number = 43, Title = "Fix database migration", IsMerged = true, HasDescription = false },
            new() { Number = 44, Title = "Update dependencies", IsMerged = false, HasDescription = true }
        ],
        Nodes =
        [
            new() { Issue = new() { Id = "TASK-001", Title = "Implement caching layer", Status = IssueStatus.Open,
                ParentIssues = [new() { ParentIssue = "TASK-003" }] }, Lane = 0, Row = 0, IsActionable = true },
            new() { Issue = new() { Id = "TASK-003", Title = "Design system architecture", Status = IssueStatus.Open }, Lane = 1, Row = 1, IsActionable = false },
            new() { Issue = new() { Id = "TASK-002", Title = "Write API tests", Status = IssueStatus.Open }, Lane = 0, Row = 2, IsActionable = true }
        ]
    };

    private TaskGraphResponse _priorityDemo = new()
    {
        TotalLanes = 2,
        MergedPrs =
        [
            new() { Number = 100, Title = "Initial commit", IsMerged = true, HasDescription = true }
        ],
        Nodes =
        [
            // P0 - Red (critical)
            new() { Issue = new() { Id = "P0-001", Title = "P0 Critical: Security vulnerability", Status = IssueStatus.Open, Priority = 0, Type = IssueType.Bug }, Lane = 0, Row = 0, IsActionable = true },
            // P1 - Orange
            new() { Issue = new() { Id = "P1-001", Title = "P1 High: Performance regression", Status = IssueStatus.Open, Priority = 1, Type = IssueType.Bug }, Lane = 0, Row = 1, IsActionable = true },
            // P2 - Yellow
            new() { Issue = new() { Id = "P2-001", Title = "P2 Medium: UI inconsistency", Status = IssueStatus.Open, Priority = 2, Type = IssueType.Task }, Lane = 0, Row = 2, IsActionable = true },
            // P3 - Green
            new() { Issue = new() { Id = "P3-001", Title = "P3 Low: Documentation update", Status = IssueStatus.Open, Priority = 3, Type = IssueType.Chore }, Lane = 0, Row = 3, IsActionable = true },
            // P4 - Blue
            new() { Issue = new() { Id = "P4-001", Title = "P4 Lowest: Nice to have feature", Status = IssueStatus.Open, Priority = 4, Type = IssueType.Feature }, Lane = 0, Row = 4, IsActionable = true },
            // No priority - Grey
            new() { Issue = new() { Id = "NP-001", Title = "No priority: Unclassified issue", Status = IssueStatus.Open, Priority = null, Type = IssueType.Task }, Lane = 0, Row = 5, IsActionable = true }
        ]
    };

    private TaskGraphResponse _fullMockWithPrs = new()
    {
        TotalLanes = 6,
        MergedPrs =
        [
            new() { Number = 97, Title = "Remove models page navigation entry", IsMerged = true, HasDescription = true },
            new() { Number = 98, Title = "Fix Test Agent button and SignalR debug panel", IsMerged = true, HasDescription = true },
            new() { Number = 99, Title = "Allow agent sessions to be resumed", IsMerged = true, HasDescription = false },
            new() { Number = 100, Title = "Add mock services for testing without production data", IsMerged = true, HasDescription = true },
            new() { Number = 101, Title = "Fix Node.js Docker build stage for Tailwind CSS compilation", IsMerged = true, HasDescription = true }
        ],
        HasMorePastPrs = true,
        Nodes =
        [
            new() { Issue = new() { Id = "ISSUE-003", Title = "Fix login timeout bug", Status = IssueStatus.Progress, Type = IssueType.Bug }, Lane = 0, Row = 0, IsActionable = false },
            new() { Issue = new() { Id = "ISSUE-001", Title = "Add dark mode support", Status = IssueStatus.Open, Type = IssueType.Feature }, Lane = 0, Row = 1, IsActionable = true },
            new() { Issue = new() { Id = "ISSUE-010", Title = "Implement DELETE endpoints", Status = IssueStatus.Open, Type = IssueType.Task,
                ParentIssues = [new() { ParentIssue = "ISSUE-009" }] }, Lane = 0, Row = 2, IsActionable = true },
            new() { Issue = new() { Id = "ISSUE-009", Title = "Implement PUT/PATCH endpoints", Status = IssueStatus.Open, Type = IssueType.Task,
                ParentIssues = [new() { ParentIssue = "ISSUE-008" }] }, Lane = 1, Row = 3, IsActionable = false },
            new() { Issue = new() { Id = "ISSUE-011", Title = "Add request validation", Status = IssueStatus.Open, Type = IssueType.Task,
                ParentIssues = [new() { ParentIssue = "ISSUE-008" }] }, Lane = 1, Row = 4, IsActionable = false },
            new() { Issue = new() { Id = "ISSUE-008", Title = "Implement POST endpoints", Status = IssueStatus.Open, Type = IssueType.Task,
                ParentIssues = [new() { ParentIssue = "ISSUE-007" }] }, Lane = 2, Row = 5, IsActionable = false },
            new() { Issue = new() { Id = "ISSUE-012", Title = "Add rate limiting", Status = IssueStatus.Open, Type = IssueType.Task,
                ParentIssues = [new() { ParentIssue = "ISSUE-007" }] }, Lane = 2, Row = 6, IsActionable = false },
            new() { Issue = new() { Id = "ISSUE-007", Title = "Implement GET endpoints", Status = IssueStatus.Open, Type = IssueType.Task,
                ParentIssues = [new() { ParentIssue = "ISSUE-005" }] }, Lane = 3, Row = 7, IsActionable = false },
            new() { Issue = new() { Id = "ISSUE-006", Title = "Write API documentation", Status = IssueStatus.Open, Type = IssueType.Chore,
                ParentIssues = [new() { ParentIssue = "ISSUE-005" }] }, Lane = 3, Row = 8, IsActionable = true },
            new() { Issue = new() { Id = "ISSUE-013", Title = "Set up API monitoring", Status = IssueStatus.Open, Type = IssueType.Chore,
                ParentIssues = [new() { ParentIssue = "ISSUE-005" }] }, Lane = 3, Row = 9, IsActionable = false },
            new() { Issue = new() { Id = "ISSUE-005", Title = "Implement API endpoints", Status = IssueStatus.Open, Type = IssueType.Task,
                ParentIssues = [new() { ParentIssue = "ISSUE-004" }] }, Lane = 4, Row = 10, IsActionable = false },
            new() { Issue = new() { Id = "ISSUE-004", Title = "Design API schema", Status = IssueStatus.Open, Type = IssueType.Task }, Lane = 5, Row = 11, IsActionable = false },
            new() { Issue = new() { Id = "ISSUE-002", Title = "Improve mobile responsiveness", Status = IssueStatus.Open, Type = IssueType.Task }, Lane = 0, Row = 12, IsActionable = true }
        ]
    };

    private TaskGraphResponse _fullMock = new()
    {
        TotalLanes = 6,
        Nodes =
        [
            new() { Issue = new() { Id = "ISSUE-003", Title = "Fix login timeout bug", Status = IssueStatus.Progress }, Lane = 0, Row = 0, IsActionable = false },
            new() { Issue = new() { Id = "ISSUE-001", Title = "Add dark mode support", Status = IssueStatus.Open }, Lane = 0, Row = 1, IsActionable = true },
            new() { Issue = new() { Id = "ISSUE-010", Title = "Implement DELETE endpoints", Status = IssueStatus.Open,
                ParentIssues = [new() { ParentIssue = "ISSUE-009" }] }, Lane = 0, Row = 2, IsActionable = true },
            new() { Issue = new() { Id = "ISSUE-009", Title = "Implement PUT/PATCH endpoints", Status = IssueStatus.Open,
                ParentIssues = [new() { ParentIssue = "ISSUE-008" }] }, Lane = 1, Row = 3, IsActionable = false },
            new() { Issue = new() { Id = "ISSUE-011", Title = "Add request validation", Status = IssueStatus.Open,
                ParentIssues = [new() { ParentIssue = "ISSUE-008" }] }, Lane = 1, Row = 4, IsActionable = false },
            new() { Issue = new() { Id = "ISSUE-008", Title = "Implement POST endpoints", Status = IssueStatus.Open,
                ParentIssues = [new() { ParentIssue = "ISSUE-007" }] }, Lane = 2, Row = 5, IsActionable = false },
            new() { Issue = new() { Id = "ISSUE-012", Title = "Add rate limiting", Status = IssueStatus.Open,
                ParentIssues = [new() { ParentIssue = "ISSUE-007" }] }, Lane = 2, Row = 6, IsActionable = false },
            new() { Issue = new() { Id = "ISSUE-007", Title = "Implement GET endpoints", Status = IssueStatus.Open,
                ParentIssues = [new() { ParentIssue = "ISSUE-005" }] }, Lane = 3, Row = 7, IsActionable = false },
            new() { Issue = new() { Id = "ISSUE-006", Title = "Write API documentation", Status = IssueStatus.Open,
                ParentIssues = [new() { ParentIssue = "ISSUE-005" }] }, Lane = 3, Row = 8, IsActionable = true },
            new() { Issue = new() { Id = "ISSUE-013", Title = "Set up API monitoring", Status = IssueStatus.Open,
                ParentIssues = [new() { ParentIssue = "ISSUE-005" }] }, Lane = 3, Row = 9, IsActionable = false },
            new() { Issue = new() { Id = "ISSUE-005", Title = "Implement API endpoints", Status = IssueStatus.Open,
                ParentIssues = [new() { ParentIssue = "ISSUE-004" }] }, Lane = 4, Row = 10, IsActionable = false },
            new() { Issue = new() { Id = "ISSUE-004", Title = "Design API schema", Status = IssueStatus.Open }, Lane = 5, Row = 11, IsActionable = false },
            new() { Issue = new() { Id = "ISSUE-002", Title = "Improve mobile responsiveness", Status = IssueStatus.Open }, Lane = 0, Row = 12, IsActionable = true }
        ]
    };
}
