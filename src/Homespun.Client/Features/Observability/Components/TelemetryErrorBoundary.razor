@inherits ErrorBoundary
@inject ITelemetryService TelemetryService

@if (CurrentException is not null)
{
    if (ErrorContent is not null)
    {
        @ErrorContent(CurrentException)
    }
    else
    {
        <div class="error-boundary">
            <div class="error-content">
                <h2>Something went wrong</h2>
                <p>An unexpected error occurred. Please try refreshing the page.</p>
                <button class="btn btn-primary" @onclick="Recover">Try Again</button>
            </div>
        </div>
    }
}
else
{
    @ChildContent
}

@code {
    protected override Task OnErrorAsync(Exception exception)
    {
        // Track the exception in telemetry
        TelemetryService.TrackException(exception, new Dictionary<string, string>
        {
            ["Source"] = "TelemetryErrorBoundary",
            ["Type"] = exception.GetType().Name
        });

        return base.OnErrorAsync(exception);
    }
}
