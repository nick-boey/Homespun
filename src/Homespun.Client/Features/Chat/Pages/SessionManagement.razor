@page "/agents"
@inject IBreadcrumbService BreadcrumbService

<PageTitle>Agents - Homespun</PageTitle>

<h1>Agents</h1>

<div class="session-management-page">
    @if (_isLoading)
    {
        <div class="py-5">
            <div class="flex items-center justify-center gap-2">
                <BbSpinner Size="SpinnerSize.Large" />
                <span>Loading agents...</span>
            </div>
        </div>
    }
    else
    {
        <SessionsPanel OnSessionStopped="HandleSessionStopped" />
    }
</div>

@code {
    private bool _isLoading = true;

    protected override async Task OnInitializedAsync()
    {
        await BreadcrumbService.SetContextAsync(new BreadcrumbContext { PageName = "Agents" });
        _isLoading = false;
    }

    private void HandleSessionStopped()
    {
        StateHasChanged();
    }
}
